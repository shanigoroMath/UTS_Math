<!DOCTYPE html>


<html>


<!------------------情報------------------>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>2018年東大理系数学第6問</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" href="../favicon.ico">
    
    <!--latex読み込み-->
    
    <style>
    mjx-container {
        line-height: normal !important;
    }
    mjx-container[jax="SVG"] {
        overflow-x: auto;
    }
    </style>

    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$','$$']]
        },
        svg: { fontCache: 'global' }
    };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YC89KNZML0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YC89KNZML0');
</script>


</head>


<body data-problem="2018-6" id="top">


    <!------------------ヘッダ------------------>
    <header>
        
        <!--ロゴ(消した)-->
        

        <!--ナビ(消した)-->
        

    </header>
        <!-- ===== 右サイドナビ ===== -->
<button id="side-toggle">☰</button>

<aside id="side-nav">
  <div id="problem-badge"></div>
  <button id="side-close">×</button>
  <nav class="td">
    <ul id="side-nav-list"></ul>
  </nav>
</aside>
    <!------------------ヘッダ終了-------------->


    <!------------------メイン------------------>
    <main>
        
        <a class="gouts" href="../index.html"></a>

<div class="bookmark-box">
  <button id="bookmark-btn">□</button>
  <span id="bookmark-count">ブックマーク</span>
</div>
        <div class="paragraph">
            
            <h2><div>東大理系数学 2018-6</div></h2>

            <div class="emphbox">
                <p>座標空間内の4点 $O(0,0,0),A(1,0,0),B(1,1,0),C(1,1,1)$ を考える。$\dfrac{1}{2} < r < 1$ とする。点 $P$ が線分 $OA,AB,BC$ 上を動くときに点 $P$ を中心とする半径 $r$ の球（内部を含む）が通過する部分を，それぞれ $V_1,V_2,V_3$ とする。<br>
<br>
(1)　平面 $y=t$ が $V_1,V_3$ 双方と共有点をもつような $t$ の範囲を与えよ。さらに，この範囲の $t$ に対し，平面 $y=t$ と $V_1$ の共通部分および平面 $y=t$ と $V_3$ の共通部分を同一平面上に図示せよ。<br>
<br>
(2)　$V_1$ と $V_3$ の共通部分が $V_2$ に含まれるための $r$ についての条件を求めよ。<br>
<br>
(3)　$r$ は (2) の条件を満たすとする。$V_1$ の体積を $S$ とし，$V_1$ と $V_2$ の共通部分の体積を $T$ とする。$V_1,V_2,V_3$ を合わせて得られる立体 $V$ の体積を $S$ と $T$ を用いて表せ。<br>
<br>
(4)　ひきつづき $r$ は (2) の条件を満たすとする。$S$ と $T$ を求め，$V$ の体積を決定せよ。</p>
            </div>

        </div>

        <div class="paragraph">

            <h2><div>方針、略解</div></h2>

            <p>(1)球状のバターをフライパン上で滑らせながら溶かしているイメージです。<br>
              (2)最遠点が条件を満たすことが必要十分になります。<br>
              (3)あの原理を使いましょう。<br>
              (4)シンプルな求積に帰着されたので、定石通り断面を積分。
                <div class="toggle-box">
                    <input type="checkbox" id="2025--">
                    <label for="2025--"
                    class="toggle-label">▶ 解答例(スキャン画像)(タップで拡大)</label>
                    <div class="toggle-content longanswer">
                        <img src="figure/20260121_111655.jpg" class="clickable-img" onclick="openImgModal(this.src)">
                    </div>
                </div>
                <p>＞(1)の図示について：本当は2通りありますが、これだけ描けば十分だと思います。(T進の採点基準もこれで満点となっていました)</p>
                <p>＞全体的に今回の解答例は「行間多め」です。</p>
            </p>

        </div>

        <div class="paragraph">

            <h2><div>動く図解</div></h2>

            
            <img src="figure/スクリーンショット 2026-01-21 142528.png" width="160px">
            <img src="figure/無題のビデオ ‐ Clipchampで作成.gif" width="250px">
            <img src="figure/20186.gif" width="250px">
        </div>

        <div class="paragraph">

            <h2><div>問題の背景</div></h2>

            <p>状況把握が難しい求積の問題です。おそらくこの問題の一番ネックな部分は(3)です。丁寧に図を描いてから重なる部分を想像しつつ処理することも出来なくはないですが、相当のセンスを要するでしょう。<br><br>これは私の個人的な好みでもありますが、<span class="ora">応用性が高く、かつ自然で合理的な解法</span>を紹介しておいた方がタメになると思っているので、今回は <span class="ora">$V_1\cup V_2 \cup V_3$</span> という構造からも想起される「あの」原理についての話をします。</p>

            <h3>重なりのあるモノの大きさを測るには?</h3>

            <p>モノ（数学的には集合）がいくつかあるのを想像してみましょう。それは図形や立体（点の集合）だったり、何らかの確率で起こる事象だったり、数列だったり、順列や組合せだったりもします。このときこんな質問をします。</p>

            <p class="yel">「全てのモノからカブリのないように中身を集めたら、大きさ(※)はいくつになる？」</p>

            <p>図形であれば、(※)は和集合の面積／体積のことを言っています。同様に事象であれば和事象の確率、数列や順列であれば個数のことであるのはなんとなくイメージできるでしょう。これらは全て、何らかの意味において「大きさ」を表しています。</p>

            <p>仮に重なりがなければ、どの例においてもそれぞれの「大きさ」を足せばそれで終わりです。（確率とかだと排反と呼びますね）</p>

            <p>しかし多くの場合、モノとモノは共通部分を持ちます。（円柱が交差していたり、数列に同じ項があったり、事象が排反でなかったり...）そんなとき、「一度足してから共通部分を引く」という方法は数多く目にしたことがあるでしょう。これを定式化したものが、本問でも登場した<span class="ora">包除原理</span>です。ベン図を利用して視覚化すると理解が深まると思うので、自分で描いてみることをオススメします。<br>（本問において $|V_3\cap V_1|$ と $|V_1\cap V_2\cap V_3|$ が打ち消しあった理由も明らかになります！）</p>





            
            <div class="emphbox">
              <p>包除原理：</p>
              $$\begin{align}|A\cup B| \ = \ &|A|+|B|-{\color{yellow}\boldsymbol{|A\cap B|}}\\\\|A\cup B\cup C| \ = \ &|A|+|B|+|C|\\&-{\color{yellow}\boldsymbol{|A\cap B|}}-{\color{yellow}\boldsymbol{|B\cap C|}}-{\color{yellow}\boldsymbol{|C\cap A|}}\\&\qquad+{\color{cyan}\boldsymbol{|A\cap B\cap C|}}\end{align}$$

              <div class="toggle-box">
                    <input type="checkbox" id="2018-gen">
                    <label for="2018-gen"
                    class="toggle-label">▶ オマケ：一般化</label>
                    <div class="toggle-content"> $$|A_1\cup\cdots\cup A_k|=\sum_{i=1}^k(-1)^{i+1}\sum_{1\leqq j_1 < \cdots < j_i\leqq k}|A_{j_1}\cap\cdots\cap A_{j_i}|$$

                      <p style="text-align:left;">実際に $k=4$ で書き出してみると、解と係数の関係に似た構造を持つことが分かります。 <br>

                      $$\begin{align}|A\cup B\cup C\cup D| \ = \ &|A|+|B|+|C|+|D|\qquad\cdots\qquad(3次の項の係数)\\&-{\color{blue}\boldsymbol{|A\cap B|}}-{\color{blue}\boldsymbol{|A\cap C|}}-{\color{blue}\boldsymbol{|A\cap D|}}-{\color{blue}\boldsymbol{|B\cap C|}}-{\color{blue}\boldsymbol{|B\cap D|}}-{\color{blue}\boldsymbol{|C\cap D|}}\qquad\cdots\qquad(2次の項の係数)\\&\qquad+{\color{red}\boldsymbol{|A\cap B\cap C|}}+{\color{red}\boldsymbol{|A\cap B\cap D|}}+{\color{red}\boldsymbol{|A\cap C\cap D|}}+{\color{red}\boldsymbol{|B\cap C\cap D|}}\qquad\cdots\qquad(1次の項の係数)\\&\qquad\qquad-{\color{purple}\boldsymbol{|A\cap B\cap C\cap D|}}\qquad\cdots\qquad(定数項)\end{align}$$

                      </p>
                      </div>
                      
              </div>
              
            </div>



            

            <p>包除原理は、いかなる概念であっても、それが「モノ」である限りは必ず適用できます。そのため、「カブリ」を持つ概念が出てきてよく分からなくなったら、包除原理が頼れるかもしれません。是非類題等で試してみてください！<p>

            
          
        </div>

           
            

        <div class="paragraph">

            <h2><div>類題紹介</div></h2>

            <div class="emphbox">
              <p>実数 $a,b,c$ に対し、関数 $f(a,b,c)=2a-bc-1$ を考える。</p>
              <p>ここで、実数 $x,y,z$ に関する条件 $A,B,C,P$ を次のように定める。</p>
              <p>$$\begin{cases}A:f(x,y,z)\geqq0\\B:f(y,z,x)\geqq0\\C:f(z,x,y)\geqq0\\P:x+y+z\leqq\frac12\end{cases}$$</p>
              <p>以下の条件を満たす座標空間上の点 $(x,y,z)$ の動きうる範囲 $W$ の体積を求めよ。</p>
              <p>（条件）： $x,y,z$ はいずれも0以上1以下であり、「 $A$ または $B$ または $C$ または $P$ 」を満たす</p><br>（東大模試　改）
              <br><br>
              <div class="toggle-box" style="text-align: left;">
                <input type="checkbox" id="2018-6-q">
                <label for="2018-6-q"
                class="toggle-label">▶ ひとこと</label>
                <div class="toggle-content longanswer" style="text-align: left;">   
                  <p>包除原理を知らなかった場合、途方もない断面積分に頼るしかなかったであろう。<br>
                  しかし包除原理を適用するだけで、非常に単純な積分に帰着される。<br>
                  先述の「オマケ」の通り、解と係数の関係を意識しながら書くと明快。</p>

                  <p>$$\begin{align}|A\cup B\cup C\cup P| \ = \ &|A|+|B|+|C|+|P|\\&-{\color{blue}\boldsymbol{|A\cap B|}}-{\color{blue}\boldsymbol{|A\cap C|}}-{\color{purple}\boldsymbol{|A\cap P|}}-{\color{blue}\boldsymbol{|B\cap C|}}-{\color{purple}\boldsymbol{|B\cap P|}}-{\color{purple}\boldsymbol{|C\cap P|}}\\&\qquad+{\color{red}\boldsymbol{|A\cap B\cap C|}}+{\color{green}\boldsymbol{|A\cap B\cap P|}}+{\color{green}\boldsymbol{|A\cap C\cap P|}}+{\color{green}\boldsymbol{|B\cap C\cap P|}}\\&\qquad\qquad-{\color{brown}\boldsymbol{|A\cap B\cap C\cap P|}}\\ = \ &3|A|+|P|-{\color{blue}3|A\cap B|}-{\color{purple}3|A\cap P|+{\color{green}3|A\cap B\cap P|}}+{\color{red}|A\cap B\cap C\cap \overline{P}|}\\ = \ &3|A\cap \overline{P}|-3|A\cap B\cap \overline{P}|+|P|+|A\cap B\cap C\cap \overline{P}|\end{align}$$</p>

                  <p>あとはそれぞれの項について $z=t$ での断面を考えれば、</p>
                  <p>$$|A\cup B\cup C\cup P|=3|A\cap \overline{B}|+|P|$$</p>
                  <p>ここまで簡単になる。</p>
                </div>
            </div>
              </div><br>
            
            <div class="emphbox">$(1,2,3,\cdots,n)$ を並び替えて出来る数列$(c_1,c_2,c_3,\cdots,c_n)$ について、$1$以上$n$以下の任意の整数$i$に対し$c_i\neq i$ が成り立つようなものの個数を$D_n$とする。言い換えれば、次の条件を満たす数列の個数が $D_n$ である。<br><br>
            <p>（条件）： $(1,\cdots,n)$ の並び替えであって、「 $c_1\neq1$ かつ $c_2\neq2$かつ　$\cdots$　かつ$c_n\neq n$ 」が成り立つ</p>
            <p>このとき、 $D_n$ が次のように表せることを示せ。</p>
            <p>$$D_n=n!\sum_{k=0}^n\frac{(-1)^k}{k!}$$</p><br>(有名問題、完全順列)
          
              <br><br><div class="toggle-box" style="text-align: left;">
                <input type="checkbox" id="2018-6-p">
                <label for="2018-6-p"
                class="toggle-label">▶ 初手</label>
                <div class="toggle-content">   
                  補集合を考えることで「または」を登場させ、包除原理に持ち込む。
                </div>
            </div></div><br>

            
            <div class="emphbox">
              <p>(1) 区別のある $n$ 個の玉を、区別のある3個の箱に収納する。下の条件を満たすような入れ方は何通りあるか求めよ。</p>
              <p>（条件）： 3つの箱のいずれも一つ以上玉が入っている。<br>すなわち、「1つ目が空き箱でない」かつ「2つ目が空き箱でない」かつ「3つ目が空き箱でない」ということ。</p>
              <p>(2) (1)を一般化して、箱の数を $k$ 個とする。（もちろん、これらの箱も区別がある。）<br>同様の条件を満たす入れ方を $R(n,k)$ とするとき、$R(n,k)$ が次のように表せることを示せ。</p>
              <p>$$R(n,k)=\sum_{i=1}^k(-1)^{k-i}{}_kC_ii^n$$</p><br>（有名問題、写像12相の「区別区別全射」）
            </div><br>

            <div class="emphbox">
              <p>(1) 360以下の正整数であって、360と互いに素であるものはいくつあるかを求めよ。</p>
              <p>(2) $n$ 以下の正整数であって、 $n$ と互いに素であるものの個数を $\phi(n)$ とする。<br><br>
              $n$ が $n = p_1^{e_1}p_2^{e_2}\cdots p_k^{e_k}$ ($k$ は正整数、 $p_1,\cdots, p_k$ は相異なる素数、 $e_1,\cdots, e_k$ は正整数) という形で表せるとき、 $\phi(n)$ が次の形で表されることを示せ。</p><br>
              $$\phi(n)=n\left(1-\frac{1}{p_1}\right)\left(1-\frac{1}{p_2}\right)\cdots\left(1-\frac{1}{p_k}\right)$$<br><br>(有名問題、オイラーのトーシェント関数)
            </div><br>

            <div class="emphbox">1000以下の素数は250個以下であることを示せ。<br><br>(一橋大2021)<br><br><div class="toggle-box" style="text-align: left;">
                <input type="checkbox" id="2018-6-p1">
                <label for="2018-6-p1"
                class="toggle-label">▶ 初手</label>
                <div class="toggle-content">   
                    「2,3,5,7,...のいずれかで割り切れる自然数が○○以上」を示す。もちろん全ての素数を巡るのは厳しいので、どこかで打ち切る。
                </div>
            </div></div><br>


            <div class="emphbox">
              <p>サイコロを $n$ 回振り、そこまでの出目の総積を $X_n$ とする。 $X_n$ が30で割り切れる確率を求めよ。</p>（<span class="ora">東大2003　改</span>）
              <br><br><div class="toggle-box" style="text-align: left;">
                <input type="checkbox" id="2018-6-p2">
                <label for="2018-6-p2"
                class="toggle-label">▶ 初手</label>
                <div class="toggle-content">   
                  【「 $X_n$ が2で割り切れない」または<br>「 $X_n$ が3で割り切れない」または<br>「 $X_n$ が5で割り切れない」】<br>では<span style="font-weight: bold;">ない</span>確率を求める。（ドモルガン）
                </div>
            </div>
            </div>


        </div>

        <a class="gouts" href="../index.html"></a>

    </main>
    <!------------------メイン終了-------------->


    <!------------------フッタ------------------>
    <footer>

        

        <!--権利表示-->
        <p class="copyright">&copy; <span id="year"></span> Shanigoro</p>
<script>
  document.getElementById("year").textContent = new Date().getFullYear();
</script>

    </footer>
    <!------------------フッタ終了-------------->
<script>
const badge = document.getElementById("problem-badge");
const problem = document.body.dataset.problem;

if (problem) {
  badge.textContent = problem;
  badge.style.display = "block";
}

document.addEventListener("DOMContentLoaded", () => {

  const navList = document.getElementById("side-nav-list");
  const headers = document.querySelectorAll("main h2");

  // h2 から目次生成
  headers.forEach((h, i) => {
    const id = "section-" + i;
    h.id = id;

    const li = document.createElement("li");
    const a = document.createElement("a");
    a.href = "#" + id;
    a.textContent = h.innerText.replace(/^>\s*/, "");
    li.appendChild(a);
    navList.appendChild(li);
  });

  // 現在位置ハイライト
  const links = navList.querySelectorAll("a");

  window.addEventListener("scroll", () => {
    let current = "";
    headers.forEach(h => {
      if (h.getBoundingClientRect().top < 120) {
        current = h.id;
      }
    });

    links.forEach(a => {
      a.classList.toggle(
        "active",
        a.getAttribute("href") === "#" + current
      );
    });
  });

  // 開閉処理
const nav = document.getElementById("side-nav");
const toggle = document.getElementById("side-toggle");
const close = document.getElementById("side-close");
const overlay = document.getElementById("side-overlay");

toggle.onclick = () => {
  nav.classList.toggle("open");
  overlay.classList.toggle("show");
};

close.onclick = () => {
  nav.classList.remove("open");
  overlay.classList.remove("show");
};

// 背景クリックで閉じる
overlay.onclick = () => {
  nav.classList.remove("open");
  overlay.classList.remove("show");
};

});
</script>

<a href="#top" class="go-top-float">▲</a>
<script>
const gotop = document.querySelector('.go-top-float');
window.addEventListener('scroll', () => {
  if (window.scrollY > 400) {
    gotop.classList.add('show');
  } else {
    gotop.classList.remove('show');
  }
});
</script>




<script>
document.addEventListener("DOMContentLoaded", () => {

  const key = "bookmark-" + location.pathname;

  const btn = document.getElementById("bookmark-btn");
  const count = document.getElementById("bookmark-count");

  if (!btn || !count) return;

  let bookmarked = false;

  const raw = localStorage.getItem(key);
  if (raw) {
    try {
      const data = JSON.parse(raw);
      bookmarked = !!data.bookmarked;
    } catch {}
  }

  update();

  btn.addEventListener("click", () => {
    bookmarked = !bookmarked;

    localStorage.setItem(
      key,
      JSON.stringify({
        bookmarked: bookmarked,
        title: document.title
      })
    );

    update();
  });

  function update() {
    if (bookmarked) {
      btn.classList.add("bookmarked");
      btn.textContent = "■";
      count.textContent = "ブックマーク済み";
    } else {
      btn.classList.remove("bookmarked");
      btn.textContent = "□";
      count.textContent = "ブックマーク";
    }
  }

});
</script>



<script>
function openImgModal(src) {
  const modal = document.getElementById("img-modal");
  const modalImg = document.getElementById("img-modal-content");
  modalImg.src = src;
  modal.style.display = "block";
}

function closeImgModal() {
  document.getElementById("img-modal").style.display = "none";
}
</script>




<div id="img-modal" onclick="closeImgModal()">
  <img id="img-modal-content">
</div>

</body>
<div id="side-overlay"></div>


</html>